<%= javascript_include_tag 'search' %>
<%= stylesheet_link_tag "search" %>


<header>
  <span class="left-band"></span>
  <div class="right-band">
    <h2>Buscar</h2>
    <div class="fixed-content">
      <span class="triangle"></span>
    </div>
  </div>
</header>

<div class="search-box">
  <h3>buscar en todo el site</h3>
  
  <%= form_tag search_path, :method => :get, :id => 'search' do %>
    <span>
      <%= image_tag "application/icon-len.png", :alt => 'Lupa para buscar' %>
      <input type="search" name="q" placeholder="Escribe lo que necesitas" results="5" value="<%= params[:q] %>" />
      <input type="submit" value="buscar" />
    </span>
    <a href="#" class="toggle_filters">mostrar filtros</a>
    
    <div class="filters">
      <%= check_box_tag "categories[videos]", "1", (params[:categories] && params[:categories]["videos"]), :id => "category_videos" %>
      <%= label_tag "category_videos", "Vídeos" %>
      <%= check_box_tag "categories[articulos]", "1", (params[:categories] && params[:categories]["articulos"]), :id => "category_articulos" %>
      <%= label_tag "category_articulos", "Artículos" %>
      <%= check_box_tag "categories[blog]", "1", (params[:categories] && params[:categories]["blog"]), :id => "category_blog" %>
      <%= label_tag "category_blog", "Blog" %>
      <%= check_box_tag "categories[mi-opinion]", "1", (params[:categories] && params[:categories]["mi-opinion"]), :id => "category_mi_opinion" %>
      <%= label_tag "category_mi_opinion", "Mi opinión" %>

      <%= label_tag "from", "Desde" %>
      <%= select_date Date.today, :order => [:day, :month, :year], :prefix => 'from' %>

      <%= label_tag "to", "Hasta" %>
      <%= select_date Date.today, :order => [:day, :month, :year], :prefix => 'to' %>

      <%= label_tag "author", "Autor" %>
      <%= text_field_tag "author", params[:author] %>

      <a href="#" class="toggle_filters">ocultar filtros</a>
    </div>
  <% end %>
</div>


<div class="results">
  <% unless @posts %>
    <%= flash[:alert] %>
  <% else %>
    <h3>Resultados</h3>
    <p>
      <% if @posts.total_count == 1 %>
        Se ha encontrado un resultado
      <% else %>
        Se han encontrado <em><%= @posts.total_count %></em> resultados
      <% end %>
      de búsqueda para <em><%= params[:q] %></em>
    </p>
    
    <ul>
      <%= render(:partial => 'post', :collection => @posts) %>
    </ul>
    
    <a href="<%= url_for(params) %>" style="display:none" rel="pagination">siguiente</a>
  <% end %>
</div>